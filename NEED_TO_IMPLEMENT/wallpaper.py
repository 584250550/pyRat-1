## {{{ http://code.activestate.com/recipes/435877/ (r1)import ctypesfrom PIL import Imageimport urllibfrom _winreg import *WALL_PAPER = "http://eggnob.com/spiders/baby-spiders-momma-background-high-def-wallpaper-1680x1050-23aug2010b.jpg"def convert_to_bmp(imgUrl):    #imgData = urllib2.urlopen(imgUrl).read()    FILENAME = "C:\tmp.jpg"        image =  urllib.urlretrieve(imgUrl)    return image[0] def wallpaperStretched():            keVal = "2" # 2= Streched / 0 = Centered    keyLoc = r'Control Panel\Desktop'    try:        key = OpenKey(HKEY_CURRENT_USER, keyLoc, 0, KEY_ALL_ACCESS)    except:        key = CreateKey(HKEY_CURRENT_USER, keyLoc)    SetValueEx(key, "WallpaperStyle", 0, REG_SZ, keVal)    CloseKey(key)SPI_SETDESKWALLPAPER = 20 # According to http://support.microsoft.com/default.aspx?scid=97142wallpaperStretched()tmp_image = convert_to_bmp(WALL_PAPER)ctypes.windll.user32.SystemParametersInfoA(SPI_SETDESKWALLPAPER, 0, tmp_image , 0 )## end of http://code.activestate.com/recipes/435877/ }}}